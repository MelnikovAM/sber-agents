# –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ OpenRouter

## üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ

### –®–∞–≥ 1: –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç

```bash
cd /Users/Aleksei/sber-agents/06-monitoring-qa/live
python3 configure_openrouter.py
```

### –®–∞–≥ 2: –í–≤–µ–¥–∏—Ç–µ API –∫–ª—é—á

–ü–æ–ª—É—á–∏—Ç–µ –∫–ª—é—á –Ω–∞ https://openrouter.ai/keys –∏ –≤–≤–µ–¥–∏—Ç–µ –µ–≥–æ.

### –®–∞–≥ 3: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞

```bash
make run
```

## ‚öôÔ∏è –†—É—á–Ω–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –≤—Ä—É—á–Ω—É—é, –æ—Ç–∫—Ä–æ–π—Ç–µ `.env` –∏ –∏–∑–º–µ–Ω–∏—Ç–µ:

```bash
# OpenRouter Configuration
OPENAI_API_KEY=sk-or-v1-XXXXXXXXXXXXXXXX
OPENAI_BASE_URL=https://openrouter.ai/api/v1

# –ú–æ–¥–µ–ª–∏ (–±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ)
MODEL=meta-llama/llama-3.2-3b-instruct:free
MODEL_QUERY_TRANSFORM=meta-llama/llama-3.2-3b-instruct:free
EMBEDDING_MODEL=openai/text-embedding-3-small

# RAGAS Evaluation
RAGAS_LLM_MODEL=meta-llama/llama-3.2-3b-instruct:free
RAGAS_EMBEDDING_MODEL=openai/text-embedding-3-small
RAGAS_EMBEDDING_PROVIDER=openai

# Embeddings Provider
EMBEDDING_PROVIDER=openai
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –æ—Ç–ª–∏—á–∏—è –æ—Ç Fireworks

### 1. Rate Limits

OpenRouter –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π tier –∏–º–µ–µ—Ç **—Å—Ç—Ä–æ–≥–∏–µ rate limits**:
- –ú–∞–∫—Å–∏–º—É–º 10-20 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω–µ–µ

**–†–µ—à–µ–Ω–∏–µ:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–∞–ª–µ–Ω—å–∫–∏–π –¥–∞—Ç–∞—Å–µ—Ç: `/evaluate_dataset 06-rag-qa-small`
- –ü–æ–¥–æ–∂–¥–∏—Ç–µ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–ª–∞—Ç–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç

### 2. Embeddings —á–µ—Ä–µ–∑ API

–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç Fireworks (–≥–¥–µ embeddings –ª–æ–∫–∞–ª—å–Ω—ã–µ), OpenRouter –∏—Å–ø–æ–ª—å–∑—É–µ—Ç embeddings —á–µ—Ä–µ–∑ API:
- –¢—Ä–∞—Ç—è—Ç—Å—è –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ embeddings
- –ú–µ–¥–ª–µ–Ω–Ω–µ–µ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è
- –ù–æ –Ω–µ –Ω—É–∂–Ω–æ —Å–∫–∞—á–∏–≤–∞—Ç—å 500MB –º–æ–¥–µ–ª—å

### 3. –ú–æ–¥–µ–ª–∏

**OpenRouter –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ:**
- `meta-llama/llama-3.2-3b-instruct:free` - –º–µ–Ω—å—à–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (3B vs 70B)
- –ö–∞—á–µ—Å—Ç–≤–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–∏–∂–µ
- –ù–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –æ–ø–ª–∞—Ç—ã

**OpenRouter –ø–ª–∞—Ç–Ω—ã–µ (–µ—Å–ª–∏ –µ—Å—Ç—å –∫—Ä–µ–¥–∏—Ç—ã):**
```bash
MODEL=anthropic/claude-3.5-sonnet
MODEL=openai/gpt-4o
MODEL=google/gemini-pro-1.5
```

## üîß –ß—Ç–æ –∏–∑–º–µ–Ω–∏—Ç—Å—è

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ OpenRouter

‚úÖ –ù–µ –Ω—É–∂–Ω–æ —Å–∫–∞—á–∏–≤–∞—Ç—å –º–æ–¥–µ–ª—å embeddings (—ç–∫–æ–Ω–æ–º–∏—è 500MB)  
‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ API (–ø—Ä–æ—â–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞)  
‚úÖ –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã

### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏

‚ö†Ô∏è –°—Ç—Ä–æ–≥–∏–µ rate limits –Ω–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–º tier  
‚ö†Ô∏è –ú–µ–Ω—å—à–∞—è –º–æ–¥–µ–ª—å (3B vs 70B) = –Ω–∏–∂–µ –∫–∞—á–µ—Å—Ç–≤–æ  
‚ö†Ô∏è Embeddings —Ç—Ä–∞—Ç—è—Ç API –∑–∞–ø—Ä–æ—Å—ã  
‚ö†Ô∏è –ú–µ–¥–ª–µ–Ω–Ω–µ–µ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è (589 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ = 589 API –∑–∞–ø—Ä–æ—Å–æ–≤)

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

| –ü–∞—Ä–∞–º–µ—Ç—Ä | Fireworks + HF | OpenRouter |
|----------|----------------|------------|
| LLM –∫–∞—á–µ—Å—Ç–≤–æ | 70B –º–æ–¥–µ–ª—å (–≤—ã—Å–æ–∫–æ–µ) | 3B –º–æ–¥–µ–ª—å (—Å—Ä–µ–¥–Ω–µ–µ) |
| Embeddings | –õ–æ–∫–∞–ª—å–Ω–æ, –±–µ—Å–ø–ª–∞—Ç–Ω–æ | –ß–µ—Ä–µ–∑ API, –ø–ª–∞—Ç–Ω–æ |
| Rate limits | –ú—è–≥–∫–∏–µ | –°—Ç—Ä–æ–≥–∏–µ |
| –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è | –ë—ã—Å—Ç—Ä–∞—è (–ª–æ–∫–∞–ª—å–Ω–æ) | –ú–µ–¥–ª–µ–Ω–Ω–∞—è (API) |
| –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ | –î–æ–ª–≥–∏–π (—Å–∫–∞—á–∫–∞ –º–æ–¥–µ–ª–∏) | –ë—ã—Å—Ç—Ä—ã–π |
| –°—Ç–æ–∏–º–æ—Å—Ç—å | –ü–ª–∞—Ç–Ω–æ –∑–∞ LLM | –ë–µ—Å–ø–ª–∞—Ç–Ω–æ (—Å –ª–∏–º–∏—Ç–∞–º–∏) |

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏/—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
üëç **OpenRouter** - –±–µ—Å–ø–ª–∞—Ç–Ω–æ, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è MVP

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
üëç **Fireworks + HuggingFace** - –ª—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ –∏ —Å–∫–æ—Ä–æ—Å—Ç—å

### –ö–æ–º–ø—Ä–æ–º–∏—Å—Å
üí° **OpenRouter –ø–ª–∞—Ç–Ω—ã–π tier** - —Ö–æ—Ä–æ—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ –±–µ–∑ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π

## üîô –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ Fireworks

–ï—Å–ª–∏ –∑–∞—Ö–æ—Ç–∏—Ç–µ –≤–µ—Ä–Ω—É—Ç—å—Å—è –æ–±—Ä–∞—Ç–Ω–æ:

```bash
python3 configure_fireworks.py
```

–ò–ª–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –±—ç–∫–∞–ø–∞:

```bash
cp .env.backup-fireworks .env
make run
```

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

–ü–æ—Å–ª–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è:

1. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:**
   ```bash
   make run
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—é:**
   ```
   /index
   ```
   –ó–∞–π–º–µ—Ç 2-3 –º–∏–Ω—É—Ç—ã (589 –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API)

3. **–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å:**
   ```
   –ö–∞–∫–∏–µ —É—Å–ª–æ–≤–∏—è –ø–æ –≤–∫–ª–∞–¥–∞–º?
   ```

4. **Evaluation (—Ç–æ–ª—å–∫–æ –º–∞–ª–µ–Ω—å–∫–∏–π –¥–∞—Ç–∞—Å–µ—Ç!):**
   ```
   /evaluate_dataset 06-rag-qa-small
   ```

---

**–ì–æ—Ç–æ–≤—ã –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è?** –ó–∞–ø—É—Å—Ç–∏—Ç–µ `python3 configure_openrouter.py` üöÄ

